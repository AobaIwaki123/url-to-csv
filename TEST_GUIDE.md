# 🧪 Net2Sheet Chrome拡張機能 テストガイド

## 📋 事前準備

### 1. 拡張機能のインストール
1. Chromeブラウザで `chrome://extensions/` を開く
2. 右上の「デベロッパーモード」をONにする
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. `net2sheet` フォルダを選択してインストール

### 2. 拡張機能の確認
- Chrome拡張機能一覧に「Net2Sheet」が表示されることを確認
- アイコンが表示され、有効になっていることを確認

## 🚀 基本テスト手順

### ステップ1: DevToolsパネルの確認
1. `test-page.html` をChromeで開く
2. **F12** キーを押してDevToolsを開く
3. DevToolsのタブ一覧に **「Net2Sheet」** が表示されることを確認
4. 「Net2Sheet」タブをクリックしてパネルを開く

### ステップ2: UI要素の確認
以下の要素が正しく表示されることを確認：
- [ ] GAS WebApp URL入力フィールド
- [ ] 「保存」ボタン
- [ ] 「収集開始」「収集停止」ボタン
- [ ] 「CSVダウンロード」「スプレッドシートへ送信」ボタン
- [ ] 収集件数表示
- [ ] プレビューエリア（テキストエリア）

### ステップ3: 画像収集テスト
1. **「収集開始」** ボタンをクリック
2. テストページを **F5キー** で再読み込み
3. **収集件数** がリアルタイムで増加することを確認
4. **プレビューエリア** にCSV形式のデータが表示されることを確認

### ステップ4: 動的コンテンツテスト
1. テストページで **「画像を追加読み込み」** ボタンをクリック
2. 新しい画像が追加され、収集件数が増加することを確認
3. **「異なるソースの画像を読み込み」** ボタンもテスト

### ステップ5: CSV出力テスト
1. 十分な画像データが収集されたら **「収集停止」** をクリック
2. **「CSVダウンロード」** ボタンをクリック
3. 以下を確認：
   - [ ] ダウンロードが開始される
   - [ ] ファイル名が `network_images_YYYY-MM-DD_HH-mm-ss.csv` 形式
   - [ ] 成功メッセージが表示される
   - [ ] CSVファイルに日本語ヘッダー（「ファイル名」「URL」）が含まれる

## 🔍 詳細テスト項目

### 画像形式の検出テスト
以下の画像形式が正しく収集されることを確認：
- [ ] `.jpg` / `.jpeg`
- [ ] `.png`
- [ ] `.gif`
- [ ] `.webp`
- [ ] `.svg`
- [ ] `.avif`
- [ ] `.bmp`
- [ ] `.ico`

### エラーハンドリングテスト
1. **空データでのCSV出力**
   - データなしでCSVダウンロードを試行
   - 適切なエラーメッセージが表示されることを確認

2. **無効なURL処理**
   - ネットワークエラーが発生しても拡張機能が停止しないことを確認

### パフォーマンステスト
1. **大量画像の処理**
   - テストページで画像を大量追加し、パフォーマンスを確認
   - プレビューエリアの更新がスムーズであることを確認

2. **メモリ使用量**
   - 長時間の収集でメモリリークがないことを確認
   - DevToolsのメモリタブで監視

## 🐛 トラブルシューティング

### よくある問題と解決方法

**1. DevToolsに「Net2Sheet」タブが表示されない**
- 拡張機能が正しくインストールされているか確認
- DevToolsを閉じて再度開く
- ページを再読み込みしてからDevToolsを開く

**2. 画像が収集されない**
- 「収集開始」ボタンが押されているか確認
- ページを再読み込みして新しいネットワークリクエストを発生させる
- コンソールエラーがないか確認

**3. CSVダウンロードが動作しない**
- ブラウザのダウンロード設定を確認
- ポップアップブロッカーが無効になっているか確認
- JavaScript エラーがないかコンソールで確認

**4. データが表示されない**
- プレビューエリアが空の場合は画像リクエストが発生していない可能性
- Networkタブで実際に画像リクエストが発生しているか確認

### デバッグ情報の確認
1. **コンソールログ**
   - DevToolsのConsoleタブで拡張機能のログを確認
   - `Net2Sheet panel created successfully` メッセージを確認

2. **ネットワークタブ**
   - DevToolsのNetworkタブで画像リクエストを確認
   - フィルターを「Img」に設定して画像のみを表示

3. **ストレージ**
   - DevTools > Application > Storage > Local Storage
   - GAS URL設定が正しく保存されているか確認

## ✅ テスト完了チェックリスト

基本機能：
- [ ] DevToolsパネルが正常に表示される
- [ ] 画像リクエストが正しく収集される
- [ ] リアルタイムでUI更新される
- [ ] CSV出力が正常に動作する
- [ ] 日本語ヘッダーが正しく出力される
- [ ] タイムスタンプ付きファイル名が生成される

エラーハンドリング：
- [ ] 空データ時の適切なエラーメッセージ
- [ ] 無効なURLの適切な処理
- [ ] JavaScript エラーが発生しない

パフォーマンス：
- [ ] 大量画像でもスムーズに動作
- [ ] メモリリークが発生しない
- [ ] プレビュー更新が高速

## 📊 期待される結果

**正常なCSV出力例：**
```csv
"ファイル名","URL"
"image1.jpg","https://picsum.photos/400/300?random=1"
"placeholder.png","https://via.placeholder.com/400x300/FF6B6B/FFFFFF.png"
"camera.svg","https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/icons/camera.svg"
```

**期待される動作：**
- 5-10秒で10-20件の画像データが収集される
- プレビューエリアに即座にデータが表示される
- CSVファイルが1秒以内にダウンロードされる
- エラーが発生せずスムーズに動作する

このテストガイドに従って、Net2Sheet拡張機能の全機能を確認してください！
